<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8">
  <title>Family Calendar</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #0f172a;
      color: white;
      margin: 0;
      padding: 0;
      overflow-x: hidden;
      transition: background 0.3s, color 0.3s;
    }
    body.light { background: white; color: black; }
    body.light header { background: #e2e8f0; }

    header {
      text-align: center;
      padding: 20px;
      background: #1e293b;
    }
    h1 { margin: 0; }
    .section { padding: 20px; }

    .event {
      position: relative;
      background: #1e293b;
      margin: 10px 0;
      padding: 10px 15px 10px 20px;
      border-radius: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .event::before {
      content: "";
      position: absolute;
      left: 0; top: 0;
      width: 6px; height: 100%;
      border-radius: 6px 0 0 6px;
    }
    .event.mama::before { background: hotpink; }
    .event.tata::before { background: orange; }
    .event.eu::before { background: turquoise; }
    .event.mama.tata::before { background: linear-gradient(to bottom, hotpink 50%, orange 50%); }
    .event.mama.eu::before { background: linear-gradient(to bottom, hotpink 50%, turquoise 50%); }
    .event.tata.eu::before { background: linear-gradient(to bottom, orange 50%, turquoise 50%); }

    .actions { display: flex; gap: 8px; }
    .actions button {
      background: #3b82f6;
      border: none;
      color: white;
      font-size: 16px;
      cursor: pointer;
      border-radius: 10px;
      padding: 5px 10px;
    }

    .add-form {
      position: fixed;
      top: 0; right: -270px;
      width: 250px; height: 100%;
      background: #1e293b;
      padding: 20px;
      box-shadow: -2px 0 5px rgba(0,0,0,0.5);
      transition: right 0.3s ease;
      z-index: 999;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    .add-form.open { right: 0; }
    .add-form h2 { margin-top: 0; }
    .add-form input, .add-form select, .add-form button {
      width: 100%; padding: 8px;
      border-radius: 10px; border: none;
    }
    .add-form button {
      background: #3b82f6; color: white;
      font-weight: bold; cursor: pointer;
    }

    .toggle-btn {
      position: fixed;
      top: 10px; right: 10px;
      background: #3b82f6; color: white;
      border-radius: 10px;
      padding: 8px 12px;
      cursor: pointer; font-weight: bold;
      z-index: 1000;
    }

    .done-section {
      padding: 20px;
      background: #1e293b;
      margin-top: 20px;
      display: none;
    }
    .done-section.visible { display: block; }

    .event.done { opacity: 0.7; }

    .preview {
      padding: 20px;
      margin-top: 20px;
      background: #1e293b;
      border-radius: 10px;
    }

    /* Alexa Mode */
    #alexa {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      display: none;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      font-size: 3em;
      color: white;
      z-index: 2000;
      background-size: cover;
      background-position: center;
    }
    #exit-alexa {
      position: absolute;
      top: 20px;
      right: 20px;
      background: rgba(0,0,0,0.6);
      color: white;
      border: none;
      border-radius: 15px;
      padding: 10px 20px;
      font-size: 1em;
      cursor: pointer;
    }

    /* Confetti */
    .confetti {
      position: fixed;
      width: 8px; height: 14px;
      top: -20px;
      opacity: 0.9;
      z-index: 3000;
    }
  </style>
</head>
<body>
  <header>
    <h1>Family Calendar</h1>
    <p id="today"></p>
  </header>

  <div class="section">
    <h2>AstƒÉzi</h2>
    <div id="today-events"></div>

    <div class="preview">
      <h2>SƒÉptƒÉm√¢na aceasta</h2>
      <div id="week-events"></div>
    </div>
  </div>

  <div class="done-section" id="done-section">
    <h2>ActivitƒÉ»õi finalizate</h2>
    <div id="done-events"></div>
  </div>

  <div class="toggle-btn" onclick="toggleForm()">‚ò∞</div>

  <div class="add-form" id="form">
    <h2>AdaugƒÉ activitate</h2>
    <input type="text" id="desc" placeholder="Descriere">
    <input type="date" id="date">
    <input type="time" id="time">
    <select id="person1">
      <option value="mama">Mama</option>
      <option value="tata">Tata</option>
      <option value="eu">Eu</option>
    </select>
    <select id="person2">
      <option value="">‚Äî nimeni ‚Äî</option>
      <option value="mama">Mama</option>
      <option value="tata">Tata</option>
      <option value="eu">Eu</option>
    </select>
    <button onclick="addEvent()">AdaugƒÉ</button>

    <hr>
    <button onclick="toggleDone()">‚úÖ Vezi activitƒÉ»õi bifate</button>
    <button onclick="toggleTheme()">üé® SchimbƒÉ fundal</button>
    <input type="text" id="bgLink" placeholder="Link imagine Alexa">
    <button onclick="toggleAlexa()">üïí Modul Alexa</button>
  </div>

  <div id="alexa">
    <button id="exit-alexa" onclick="toggleAlexa()">‚Ü© Ie»ôire</button>
    <div id="alexa-clock"></div>
    <div id="alexa-date"></div>
  </div>

  <script>
    const todayEl = document.getElementById("today");
    const today = new Date();
    todayEl.textContent = today.toLocaleDateString("ro-RO", { weekday: 'long', day: 'numeric', month: 'long', year: 'numeric' });

    function toggleForm() {
      document.getElementById("form").classList.toggle("open");
    }
    function toggleDone() {
      document.getElementById("done-section").classList.toggle("visible");
    }
    function toggleTheme() {
      document.body.classList.toggle("light");
    }

    function addEvent() {
      const desc = document.getElementById("desc").value;
      const date = document.getElementById("date").value;
      const time = document.getElementById("time").value;
      const p1 = document.getElementById("person1").value;
      const p2 = document.getElementById("person2").value;
      if (!desc || !date || !time) return;

      const div = document.createElement("div");
      div.className = "event " + p1 + (p2 ? " " + p2 : "");
      div.innerHTML = `
        <div>
          <div>${desc}</div>
          <div class="meta">${date} ‚Äî ${time} ‚Äî ${p1}${p2 ? ", " + p2 : ""}</div>
        </div>
        <div class="actions">
          <button class="done-btn">‚úÖ</button>
          <button class="delete-btn">‚ùå</button>
        </div>`;

      const now = new Date();
      const d = new Date(date);
      const diffDays = Math.floor((d - now) / (1000*60*60*24));

      if (date === new Date().toISOString().split("T")[0]) {
        document.getElementById("today-events").appendChild(div);
      } else if (diffDays >= 0 && diffDays < 7) {
        document.getElementById("week-events").appendChild(div);
      } else {
        alert("Activitatea trebuie sƒÉ fie azi sau √Æn aceastƒÉ sƒÉptƒÉm√¢nƒÉ.");
        return;
      }

      reattachActions();
      saveEvents();
      document.getElementById("desc").value = "";
    }

    function reattachActions() {
      document.querySelectorAll(".done-btn").forEach(btn => {
        btn.onclick = () => {
          const ev = btn.closest(".event");
          ev.classList.add("done");
          document.getElementById("done-events").appendChild(ev);
          saveEvents();
          checkConfetti();
        };
      });
      document.querySelectorAll(".delete-btn").forEach(btn => {
        btn.onclick = () => {
          btn.closest(".event").remove();
          saveEvents();
        };
      });
    }

    function saveEvents() {
      const all = {
        today: document.getElementById("today-events").innerHTML,
        week: document.getElementById("week-events").innerHTML,
        done: document.getElementById("done-events").innerHTML
      };
      localStorage.setItem("calendarEvents", JSON.stringify(all));
    }

    function loadEvents() {
      const data = localStorage.getItem("calendarEvents");
      if (!data) return;
      const parsed = JSON.parse(data);
      document.getElementById("today-events").innerHTML = parsed.today;
      document.getElementById("week-events").innerHTML = parsed.week;
      document.getElementById("done-events").innerHTML = parsed.done;
      reattachActions();
    }

    function checkConfetti() {
      if (document.getElementById("today-events").children.length === 0) launchConfetti();
    }

    function launchConfetti() {
      const colors = ["#f87171","#facc15","#4ade80","#60a5fa","#c084fc","#f472b6"];
      for (let i = 0; i < 80; i++) {
        const c = document.createElement("div");
        c.className = "confetti";
        c.style.left = Math.random() * window.innerWidth + "px";
        c.style.background = colors[Math.floor(Math.random()*colors.length)];
        c.style.width = Math.random() * 8 + 6 + "px";
        c.style.height = Math.random() * 8 + 6 + "px";
        c.style.borderRadius = Math.random() > 0.5 ? "50%" : "0%";
        document.body.appendChild(c);
        let fall = c.animate([
          { transform: `translate(0,0)` },
          { transform: `translate(${(Math.random()-0.5)*200}px, ${window.innerHeight}px)` }
        ], { duration: 4000 + Math.random()*2000, easing: "ease-out" });
        fall.onfinish = () => c.remove();
      }
    }

    function toggleAlexa() {
      const alexa = document.getElementById("alexa");
      if (alexa.style.display === "flex") {
        alexa.style.display = "none";
        return;
      }
      const bgLink = document.getElementById("bgLink").value;
      if (bgLink) alexa.style.backgroundImage = `url(${bgLink})`;
      else alexa.style.background = "#000";
      alexa.style.display = "flex";
      updateAlexaClock();
    }

    function updateAlexaClock() {
      const now = new Date();
      document.getElementById("alexa-clock").textContent = now.toLocaleTimeString("ro-RO");
      document.getElementById("alexa-date").textContent = now.toLocaleDateString("ro-RO", { weekday: "long", day: "numeric", month: "long" });
      if (document.getElementById("alexa").style.display === "flex") {
        setTimeout(updateAlexaClock, 1000);
      }
    }

    loadEvents();
  </script>
</body>
</html>
