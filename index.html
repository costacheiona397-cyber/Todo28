<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8">
  <title>Family Calendar</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #0f172a;
      color: white;
      margin: 0;
      padding: 0;
      overflow-x: hidden;
      transition: background 0.3s, color 0.3s;
    }

    header {
      text-align: center;
      padding: 20px;
      background: #1e293b;
    }
    h1 { margin: 0; }
    .section { padding: 20px; }

    .event {
      position: relative;
      background: #1e293b;
      margin: 10px 0;
      padding: 10px 15px 10px 20px;
      border-radius: 12px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .event::before {
      content: "";
      position: absolute;
      left: 0; top: 0;
      width: 6px; height: 100%;
      border-radius: 6px 0 0 6px;
    }
    .event.mama::before { background: hotpink; }
    .event.tata::before { background: orange; }
    .event.eu::before { background: lightgreen; }

    .meta { font-size: 0.8em; opacity: 0.8; }

    .actions { display: flex; gap: 8px; }
    .actions button {
      background: transparent;
      border: none;
      color: inherit;
      font-size: 18px;
      cursor: pointer;
    }

    .add-form {
      position: fixed;
      top: 0; right: -270px;
      width: 250px; height: 100%;
      background: #1e293b;
      padding: 20px;
      box-shadow: -2px 0 5px rgba(0,0,0,0.5);
      transition: right 0.3s ease;
      z-index: 999;
      display: flex;
      flex-direction: column;
      gap: 10px;
      border-radius: 20px 0 0 20px;
      overflow-y: auto;   /* üîÑ scroll vertical */
    }
    .add-form.open { right: 0; }
    .add-form h2 { margin-top: 0; }
    .add-form label { display: block; margin-top: 5px; font-size: 14px; }
    .add-form input, .add-form select, .add-form button {
      width: 100%; padding: 6px; margin-top: 4px;
      border-radius: 10px; border: none;
    }
    .add-form button {
      background: #3b82f6; color: white;
      font-weight: bold; cursor: pointer;
      border-radius: 12px;
    }

    .toggle-btn {
      position: fixed;
      top: 10px; right: 10px;
      background: #3b82f6; color: white;
      border-radius: 8px;
      padding: 8px 12px;
      cursor: pointer; font-weight: bold;
      z-index: 1000;
    }

    .done-section {
      padding: 20px;
      background: #1e293b;
      margin-top: 20px;
      display: none;
    }
    .done-section.visible { display: block; }

    .event.done { opacity: 0.7; }

    .preview {
      padding: 20px;
      margin-top: 20px;
      background: #1e293b;
      border-radius: 10px;
    }

    /* confetti realist */
    .confetti {
      position: fixed;
      width: 8px; height: 14px;
      top: -20px;
      opacity: 0.9;
      z-index: 2000;
    }

    /* Casete biblie + text */
    .daily-checks {
      display: flex;
      gap: 15px;
      justify-content: center;
      margin: 10px 0 20px 0;
    }
    .daily-checks label {
      display: flex;
      align-items: center;
      gap: 5px;
      font-size: 14px;
    }
  </style>
</head>
<body>
  <header>
    <h1>Family Calendar</h1>
    <p id="today"></p>
    <div class="daily-checks">
      <label><input type="checkbox" id="bibleCheck"> Citirea Bibliei</label>
      <label><input type="checkbox" id="textCheck"> Textul zilei</label>
    </div>
  </header>

  <div class="section">
    <h2>AstƒÉzi</h2>
    <div id="today-events"></div>

    <div class="preview">
      <h2>SƒÉptƒÉm√¢na aceasta</h2>
      <div id="week-events"></div>
    </div>
  </div>

  <div class="done-section" id="done-section">
    <h2>ActivitƒÉ»õi finalizate</h2>
    <div id="done-events"></div>
  </div>

  <div class="toggle-btn" onclick="toggleForm()">‚ò∞</div>

  <div class="add-form" id="form">
    <h2>AdaugƒÉ activitate</h2>
    <label>Descriere</label>
    <input type="text" id="desc">
    <label>Data »ôi ora</label>
    <input type="datetime-local" id="datetime">
    <label>Persoane</label>
    <select id="person1">
      <option value="mama">Mama</option>
      <option value="tata">Tata</option>
      <option value="eu">Eu</option>
    </select>
    <select id="person2">
      <option value="">‚Äî nimeni ‚Äî</option>
      <option value="mama">Mama</option>
      <option value="tata">Tata</option>
      <option value="eu">Eu</option>
    </select>
    <button onclick="addEvent()">AdaugƒÉ</button>

    <hr>
    <button onclick="toggleDone()">Vezi activitƒÉ»õi bifate</button>
    <button onclick="toggleTheme()">SchimbƒÉ fundal</button>
  </div>

  <script>
    const todayEl = document.getElementById("today");
    const today = new Date();
    todayEl.textContent = today.toLocaleDateString("ro-RO", { weekday: 'long', day: 'numeric', month: 'long', year: 'numeric' });

    const todayStr = new Date().toISOString().split("T")[0];

    function toggleForm() {
      document.getElementById("form").classList.toggle("open");
    }
    function toggleDone() {
      document.getElementById("done-section").classList.toggle("visible");
    }
    function toggleTheme() {
      document.body.classList.toggle("light");
    }

    function saveEvents() {
      const all = {
        today: document.getElementById("today-events").innerHTML,
        week: document.getElementById("week-events").innerHTML,
        done: document.getElementById("done-events").innerHTML,
        bible: document.getElementById("bibleCheck").checked,
        text: document.getElementById("textCheck").checked,
        savedDate: todayStr
      };
      localStorage.setItem("calendarEvents", JSON.stringify(all));
    }

    function loadEvents() {
      const data = localStorage.getItem("calendarEvents");
      if (!data) return;
      const parsed = JSON.parse(data);

      // Reset dacƒÉ a trecut ziua
      if (parsed.savedDate !== todayStr) {
        localStorage.removeItem("calendarEvents");
        return;
      }

      document.getElementById("today-events").innerHTML = parsed.today;
      document.getElementById("week-events").innerHTML = parsed.week;
      document.getElementById("done-events").innerHTML = parsed.done;
      document.getElementById("bibleCheck").checked = parsed.bible;
      document.getElementById("textCheck").checked = parsed.text;
      reattachActions();
    }

    function reattachActions() {
      document.querySelectorAll(".done-btn").forEach(btn => {
        btn.onclick = () => {
          const ev = btn.closest(".event");
          ev.classList.add("done");
          document.getElementById("done-events").appendChild(ev);
          saveEvents();
          checkConfetti();
        };
      });
      document.querySelectorAll(".delete-btn").forEach(btn => {
        btn.onclick = () => {
          btn.closest(".event").remove();
          saveEvents();
          checkConfetti();
        };
      });
    }

    function addEvent() {
      const desc = document.getElementById("desc").value;
      const datetime = document.getElementById("datetime").value;
      const p1 = document.getElementById("person1").value;
      const p2 = document.getElementById("person2").value;

      if (!desc || !datetime) return;

      const d = new Date(datetime);
      const dateStr = d.toISOString().split("T")[0];
      const timeStr = d.toLocaleTimeString("ro-RO", { hour: '2-digit', minute: '2-digit' });

      const div = document.createElement("div");
      div.className = "event " + p1 + (p2 ? " " + p2 : "");

      const content = document.createElement("div");
      content.innerHTML = `<div>${desc}</div>
                           <div class="meta">${dateStr} ‚Äî ${timeStr} ‚Äî ${p1}${p2 ? ", " + p2 : ""}</div>`;

      const actions = document.createElement("div");
      actions.className = "actions";
      actions.innerHTML = `<button class="done-btn">‚úÖ</button><button class="delete-btn">‚ùå</button>`;

      div.appendChild(content);
      div.appendChild(actions);

      const now = new Date();
      const diffDays = Math.floor((d - now) / (1000*60*60*24));

      if (dateStr === todayStr) {
        document.getElementById("today-events").appendChild(div);
      } else if (diffDays >= 0 && diffDays < 7) {
        document.getElementById("week-events").appendChild(div);
      } else {
        alert("Activitatea nu e azi sau sƒÉptƒÉm√¢na asta.");
        return;
      }

      reattachActions();
      saveEvents();

      document.getElementById("desc").value = "";
      document.getElementById("datetime").value = "";
      document.getElementById("person2").value = "";
    }

    function checkConfetti() {
      const todayEv = document.getElementById("today-events").children.length;
      if (todayEv === 0) launchConfetti();
    }

    function launchConfetti() {
      const colors = ["#f87171","#facc15","#4ade80","#60a5fa","#c084fc","#f472b6"];
      for (let i = 0; i < 80; i++) {
        const c = document.createElement("div");
        c.className = "confetti";
        c.style.left = Math.random() * window.innerWidth + "px";
        c.style.background = colors[Math.floor(Math.random()*colors.length)];
        c.style.width = Math.random() * 8 + 6 + "px";
        c.style.height = Math.random() * 8 + 6 + "px";
        c.style.borderRadius = Math.random() > 0.5 ? "50%" : "0%";
        document.body.appendChild(c);

        let angle = Math.random()*360;
        let xMove = (Math.random() - 0.5) * 200;
        let fall = c.animate([
          { transform: `translate(0,0) rotate(${angle}deg)` },
          { transform: `translate(${xMove}px, ${window.innerHeight}px) rotate(${angle+720}deg)` }
        ], {
          duration: 3000 + Math.random()*2000,
          easing: "ease-out"
        });
        fall.onfinish = () => c.remove();
      }
    }

    document.getElementById("bibleCheck").addEventListener("change", saveEvents);
    document.getElementById("textCheck").addEventListener("change", saveEvents);

    loadEvents();
  </script>
</body>
</html>
